<!--
CO_OP_TRANSLATOR_METADATA:
{
  "original_hash": "6e562d7e5a77c8982da4aa8f762ad1d8",
  "translation_date": "2025-07-14T02:50:18+00:00",
  "source_file": "05-AdvancedTopics/mcp-security-entra/README.md",
  "language_code": "ur"
}
-->
# AI ูุฑฺฉ ููู ฺฉ ุญูุงุธุช: ูุงฺู ฺฉุงููนฺฉุณูน ูพุฑููนูฺฉูู ุณุฑูุฑุฒ ฺฉ ู Entra ID ุชุตุฏู

## ุชุนุงุฑู  
ุงูพู ูุงฺู ฺฉุงููนฺฉุณูน ูพุฑููนูฺฉูู (MCP) ุณุฑูุฑ ฺฉู ูุญููุธ ุจูุงูุง ุจุงูฺฉู ูุณุง  ุถุฑูุฑ  ุฌุณ ุขูพ ุงูพู ฺฏฺพุฑ ฺฉุง ูุฑฺฉุฒ ุฏุฑูุงุฒ ุจูุฏ ฺฉุฑุช ฺบ ุงฺฏุฑ ุขูพ ฺฉุง MCP ุณุฑูุฑ ฺฉฺพูุง ุฑ ุชู ุขูพ ฺฉ ูนููุฒ ุงูุฑ ฺูนุง ุบุฑ ูุฌุงุฒ ุฑุณุงุฆ ฺฉ ู ูุนุฑุถู ุฎุทุฑ ุจู ุฌุงุช ฺบุ ุฌู ุณฺฉูุฑูน ุฎูุงู ูุฑุฒูฺบ ฺฉุง ุจุงุนุซ ุจู ุณฺฉุชุง  Microsoft Entra ID ุงฺฉ ูุถุจูุท ฺฉูุงุคฺ ุจุณฺ ุดูุงุฎุช ุงูุฑ ุฑุณุงุฆ ููุฌูููน ุญู ูุฑุงู ฺฉุฑุชุง ุ ุฌู ูู ุจูุงุชุง  ฺฉ ุตุฑู ูุฌุงุฒ ุตุงุฑูู ุงูุฑ ุงูพูฺฉุดูุฒ  ุขูพ ฺฉ MCP ุณุฑูุฑ ุณ ุฑุงุจุท ฺฉุฑ ุณฺฉฺบ ุงุณ ุณฺฉุดู ูฺบุ ุขูพ ุณฺฉฺพฺบ ฺฏ ฺฉ Entra ID ุชุตุฏู ฺฉ ุฐุฑุน ุงูพู AI ูุฑฺฉ ููู ฺฉู ฺฉุณ ูุญููุธ ุจูุงุง ุฌุงุฆ

## ุณฺฉฺพู ฺฉ ููุงุตุฏ  
ุงุณ ุณฺฉุดู ฺฉ ุงุฎุชุชุงู ุชฺฉุ ุขูพ ูุงุจู ูฺบ ฺฏ ฺฉ:

- MCP ุณุฑูุฑุฒ ฺฉ ุญูุงุธุช ฺฉ ุงูุช ฺฉู ุณูุฌฺพฺบ  
- Microsoft Entra ID ุงูุฑ OAuth 2.0 ุชุตุฏู ฺฉ ุจูุงุฏ ุจุงุชูฺบ ฺฉ ูุถุงุญุช ฺฉุฑฺบ  
- ุนูุงู ุงูุฑ ุฎู ฺฉูุงุฆููนุณ ฺฉ ุฏุฑูุงู ูุฑู ฺฉู ูพฺุงูฺบ  
- Entra ID ุชุตุฏู ฺฉู ููุงู (ุนูุงู ฺฉูุงุฆููน) ุงูุฑ ุฏูุฑ ุฏุฑุงุฒ (ุฎู ฺฉูุงุฆููน) MCP ุณุฑูุฑ ฺฉ ููุธุฑูุงููฺบ ูฺบ ูุงูุฐ ฺฉุฑฺบ  
- AI ูุฑฺฉ ููู ุชุงุฑ ฺฉุฑุช ููุช ุณฺฉูุฑูน ฺฉ ุจุชุฑู ูุดูฺบ ุงูพูุงุฆฺบ

## ุณฺฉูุฑูน ุงูุฑ MCP  

ุฌุณ ุขูพ ุงูพู ฺฏฺพุฑ ฺฉุง ูุฑฺฉุฒ ุฏุฑูุงุฒ ฺฉฺพูุง ูฺบ ฺฺพูฺุชุ ูุณ  ุขูพ ฺฉู ุงูพู MCP ุณุฑูุฑ ฺฉู ุจฺพ ุฑ ฺฉุณ ฺฉ ู ฺฉฺพูุง ูฺบ ฺฺพูฺูุง ฺุง ุงูพู AI ูุฑฺฉ ููู ฺฉ ุญูุงุธุช ฺฉุฑูุง ูุถุจูุทุ ูุงุจู ุงุนุชูุงุฏ ุงูุฑ ูุญููุธ ุงูพูฺฉุดูุฒ ุจูุงู ฺฉ ู ูุงฺฏุฒุฑ   ุจุงุจ ุขูพ ฺฉู Microsoft Entra ID ฺฉ ุงุณุชุนูุงู ุณ ุงูพู MCP ุณุฑูุฑุฒ ฺฉู ูุญููุธ ุจูุงู ฺฉุง ุทุฑู ุณฺฉฺพุงุฆ ฺฏุงุ ุชุงฺฉ ุตุฑู ูุฌุงุฒ ุตุงุฑูู ุงูุฑ ุงูพูฺฉุดูุฒ  ุขูพ ฺฉ ูนููุฒ ุงูุฑ ฺูนุง ุชฺฉ ุฑุณุงุฆ ุญุงุตู ฺฉุฑ ุณฺฉฺบ

## MCP ุณุฑูุฑุฒ ฺฉ ู ุณฺฉูุฑูน ฺฉูฺบ ุถุฑูุฑ   

ูุฑุถ ฺฉุฑฺบ ฺฉ ุขูพ ฺฉ MCP ุณุฑูุฑ ูฺบ ุงฺฉ ุงุณุง ูนูู  ุฌู ุง ูู ุจฺพุฌ ุณฺฉุชุง  ุง ฺฉุณูนูุฑ ฺูนุง ุจุณ ุชฺฉ ุฑุณุงุฆ ุญุงุตู ฺฉุฑ ุณฺฉุชุง  ุงฺฏุฑ ุณุฑูุฑ ุบุฑ ูุญููุธ ู ุชู ฺฉูุฆ ุจฺพ ุงุณ ูนูู ฺฉู ุงุณุชุนูุงู ฺฉุฑ ุณฺฉุชุง ุ ุฌุณ ุณ ุบุฑ ูุฌุงุฒ ฺูนุง ุชฺฉ ุฑุณุงุฆุ ุงุณูพู ุง ุฏฺฏุฑ ููุตุงู ุฏ ุณุฑฺฏุฑูุงฺบ ู ุณฺฉุช ฺบ

ุชุตุฏู ูุงูุฐ ฺฉุฑ ฺฉุ ุขูพ ูู ุจูุงุช ฺบ ฺฉ ุฑ ุฏุฑุฎูุงุณุช ฺฉ ุชุตุฏู ฺฉ ุฌุงุฆุ ุนู ุฏุฑุฎูุงุณุช ฺฉุฑู ูุงู ุตุงุฑู ุง ุงูพูฺฉุดู ฺฉ ุดูุงุฎุช ฺฉ ุชุตุฏู ู  ุขูพ ฺฉ AI ูุฑฺฉ ููู ฺฉ ุญูุงุธุช ฺฉุง ูพูุง ุงูุฑ ุณุจ ุณ ุงู ูุฏู 

## Microsoft Entra ID ฺฉุง ุชุนุงุฑู  

[**Microsoft Entra ID**](https://adoption.microsoft.com/microsoft-security/entra/) ุงฺฉ ฺฉูุงุคฺ ุจุณฺ ุดูุงุฎุช ุงูุฑ ุฑุณุงุฆ ููุฌูููน ุณุฑูุณ  ุงุณ ุขูพ ุงูพู ุงูพูฺฉุดูุฒ ฺฉ ู ุงฺฉ ุนุงูู ุณฺฉูุฑูน ฺฏุงุฑฺ ุณูุฌฺพฺบ  ุตุงุฑู ฺฉ ุดูุงุฎุช ฺฉ ุชุตุฏู (authentication) ุงูุฑ ุงุฌุงุฒุช (authorization) ฺฉ ูพฺุฏ ุนูู ฺฉู ุณูุจฺพุงูุชุง 

Entra ID ฺฉ ุงุณุชุนูุงู ุณ ุขูพ ฺฉุฑ ุณฺฉุช ฺบ:

- ุตุงุฑูู ฺฉ ู ูุญููุธ ุณุงุฆู ุงู ฺฉู ูุนุงู ฺฉุฑฺบ  
- APIs ุงูุฑ ุณุฑูุณุฒ ฺฉ ุญูุงุธุช ฺฉุฑฺบ  
- ุฑุณุงุฆ ฺฉ ูพุงูุณุงฺบ ุงฺฉ ูุฑฺฉุฒ ููุงู ุณ ููุธู ฺฉุฑฺบ

MCP ุณุฑูุฑุฒ ฺฉ ูุ Entra ID ุงฺฉ ูุถุจูุท ุงูุฑ ูุณุน ูพูุงู ูพุฑ ูุงุจู ุงุนุชูุงุฏ ุญู ูุฑุงู ฺฉุฑุชุง  ุชุงฺฉ  ฺฉููนุฑูู ฺฉุง ุฌุง ุณฺฉ ฺฉ ฺฉูู ุขูพ ฺฉ ุณุฑูุฑ ฺฉ ุตูุงุญุชูฺบ ุชฺฉ ุฑุณุงุฆ ุญุงุตู ฺฉุฑ ุณฺฉุชุง 

---

## ุฌุงุฏู ฺฉู ุณูุฌฺพูุง: Entra ID ุชุตุฏู ฺฉุณ ฺฉุงู ฺฉุฑุช   

Entra ID ุชุตุฏู ฺฉ ู **OAuth 2.0** ุฌุณ ุงููพู ุงุณูนูฺุฑฺุฒ ุงุณุชุนูุงู ฺฉุฑุชุง  ุชูุตูุงุช ูพฺุฏ ู ุณฺฉุช ฺบุ ูฺฉู ุจูุงุฏ ุชุตูุฑ ุขุณุงู  ุงูุฑ ุงฺฉ ูุซุงู ุณ ุณูุฌฺพุง ุฌุง ุณฺฉุชุง 

### OAuth 2.0 ฺฉุง ูุฑู ุชุนุงุฑู: ูููน ฺฉ  

OAuth 2.0 ฺฉู ุงูพู ฺฏุงฺ ฺฉ ู ูููน ุณุฑูุณ ุณูุฌฺพฺบ ุฌุจ ุขูพ ฺฉุณ ุฑุณุชูุฑุงู ูพูฺุช ฺบุ ุชู ุขูพ ูููน ฺฉู ุงูพู ูุงุณูนุฑ ฺฉ ูฺบ ุฏุช ุจูฺฉ ุขูพ ุงฺฉ **ูููน ฺฉ** ุฏุช ฺบ ุฌุณ ฺฉ ูุญุฏูุฏ ุงุฌุงุฒุชฺบ ูุช ฺบโ ฺฏุงฺ ุงุณูนุงุฑูน ฺฉุฑ ุณฺฉุชุง  ุงูุฑ ุฏุฑูุงุฒ ุจูุฏ ฺฉุฑ ุณฺฉุชุง ุ ูฺฉู ูนุฑูฺฉ ุง ฺฏููุฒ ฺฉููพุงุฑูนูููน ูฺบ ฺฉฺพูู ุณฺฉุชุง

ุงุณ ูุซุงู ูฺบ:

- **ุขูพ** ฺบ **ุตุงุฑู**  
- **ุขูพ ฺฉ ฺฏุงฺ**  **MCP ุณุฑูุฑ** ุฌุณ ูฺบ ููุช ูนููุฒ ุงูุฑ ฺูนุง   
- **ูููน**  **Microsoft Entra ID**  
- **ูพุงุฑฺฉูฺฏ ุงูนูฺููน**  **MCP ฺฉูุงุฆููน** (ู ุงูพูฺฉุดู ุฌู ุณุฑูุฑ ุชฺฉ ุฑุณุงุฆ ฺุงุช )  
- **ูููน ฺฉ**  **Access Token**

Access token ุงฺฉ ูุญููุธ ูุชู ฺฉ ุดฺฉู  ุฌู MCP ฺฉูุงุฆููน ฺฉู Entra ID ุณ ุณุงุฆู ุงู ฺฉ ุจุนุฏ ููุช  ฺฉูุงุฆููน ุฑ ุฏุฑุฎูุงุณุช ฺฉ ุณุงุชฺพ  ูนูฺฉู MCP ุณุฑูุฑ ฺฉู ูพุด ฺฉุฑุชุง  ุณุฑูุฑ ุงุณ ูนูฺฉู ฺฉ ุชุตุฏู ฺฉุฑ ฺฉ ูู ุจูุงุชุง  ฺฉ ุฏุฑุฎูุงุณุช ุฌุงุฆุฒ  ุงูุฑ ฺฉูุงุฆููน ฺฉ ูพุงุณ ุถุฑูุฑ ุงุฌุงุฒุชฺบ ฺบุ ุจุบุฑ ุขูพ ฺฉ ุงุตู ุงุณูุงุฏ (ุฌุณ ูพุงุณ ูุฑฺ) ฺฉู ูฺู ฺฉ

### ุชุตุฏู ฺฉุง ุนูู  

ุนูู ุทูุฑ ูพุฑ  ุทุฑู ฺฉุงุฑ ฺฉฺฺพ ูฺบ ูุชุง :

```mermaid
sequenceDiagram
    actor User as ๐ค User
    participant Client as ๐ฅ๏ธ MCP Client
    participant Entra as ๐ Microsoft Entra ID
    participant Server as ๐ง MCP Server

    Client->>+User: Please sign in to continue.
    User->>+Entra: Enters credentials (username/password).
    Entra-->>Client: Here is your access token.
    User-->>-Client: (Returns to the application)

    Client->>+Server: I need to use a tool. Here is my access token.
    Server->>+Entra: Is this access token valid?
    Entra-->>-Server: Yes, it is.
    Server-->>-Client: Token is valid. Here is the result of the tool.
```

### Microsoft Authentication Library (MSAL) ฺฉุง ุชุนุงุฑู  

ฺฉูฺ ูฺบ ุฌุงู ุณ ูพูุ ุงฺฉ ุงู ุฌุฒู ุณ ูุงูู ููุง ุถุฑูุฑ  ุฌู ุขูพ ูุซุงููฺบ ูฺบ ุฏฺฉฺพฺบ ฺฏ: **Microsoft Authentication Library (MSAL)**

MSAL ูุงุฆฺฉุฑูุณุงููน ฺฉ ุชุงุฑ ฺฉุฑุฏ ูุงุฆุจุฑุฑ  ุฌู ฺูููพุฑุฒ ฺฉ ู ุชุตุฏู ฺฉู ุขุณุงู ุจูุงุช  ุขูพ ฺฉู ุณฺฉูุฑูน ูนูฺฉูุฒุ ุณุงุฆู ุงู ููุฌูููนุ ุงูุฑ ุณุดู ุฑูุฑุด ฺฉ ูพฺุฏ ฺฉูฺ ูฺฉฺพู ฺฉ ุถุฑูุฑุช ูฺบ ูพฺุชุ ฺฉููฺฉ MSAL  ุณุจ ุฎูุฏ ุณูุจฺพุงูุชุง 

MSAL ุงุณุชุนูุงู ฺฉุฑู ฺฉ ุณูุงุฑุด ฺฉ ุฌุงุช  ฺฉููฺฉ:

- ** ูุญููุธ :**  ุงูฺุณูนุฑ ุงุณูนูฺุฑฺ ูพุฑููนูฺฉููุฒ ุงูุฑ ุณฺฉูุฑูน ฺฉ ุจุชุฑู ูุดูฺบ ูุงูุฐ ฺฉุฑุชุง ุ ุฌุณ ุณ ุขูพ ฺฉ ฺฉูฺ ูฺบ ฺฉูุฒูุฑูฺบ ฺฉุง ุฎุทุฑ ฺฉู ูุชุง   
- ** ุชุฑู ฺฉู ุขุณุงู ุจูุงุชุง :** OAuth 2.0 ุงูุฑ OpenID Connect ฺฉ ูพฺุฏ ุนูู ฺฉู ฺฺพูพุง ุฏุชุง ุ ุชุงฺฉ ุขูพ ฺูุฏ ูุงุฆููฺบ ูฺบ ูุถุจูุท ุชุตุฏู ุงูพู ุงูพูฺฉุดู ูฺบ ุดุงูู ฺฉุฑ ุณฺฉฺบ  
- ** ุจุฑูุฑุงุฑ ุฑฺฉฺพุง ุฌุงุชุง :** ูุงุฆฺฉุฑูุณุงููน MSAL ฺฉู ูุนุงู ุทูุฑ ูพุฑ ุงูพ ฺูน ฺฉุฑุชุง ุฑุชุง  ุชุงฺฉ ูุฆ ุณฺฉูุฑูน ุฎุทุฑุงุช ุงูุฑ ูพููน ูุงุฑู ุชุจุฏููฺบ ฺฉุง ููุงุจู ฺฉุง ุฌุง ุณฺฉ

MSAL ูุฎุชูู ุฒุจุงููฺบ ุงูุฑ ูุฑู ูุฑฺฉุณ ฺฉู ุณูพูุฑูน ฺฉุฑุชุง ุ ุฌุณ .NETุ JavaScript/TypeScriptุ Pythonุ Javaุ Goุ ุงูุฑ ููุจุงุฆู ูพููน ูุงุฑูุฒ ุฌุณ iOS ุงูุฑ Android ุงุณ ฺฉุง ูุทูุจ  ฺฉ ุขูพ ุงูพู ูพูุฑ ูนฺฉูุงููุฌ ุงุณูนฺฉ ูฺบ ฺฉุณุงฺบ ุชุตุฏู ุทุฑู ุงุณุชุนูุงู ฺฉุฑ ุณฺฉุช ฺบ

MSAL ฺฉ ุจุงุฑ ูฺบ ูุฒุฏ ุฌุงูู ฺฉ ูุ ุขูพ ุณุฑฺฉุงุฑ [MSAL ุงููุฑูู ุฏุณุชุงูุฒุงุช](https://learn.microsoft.com/entra/identity-platform/msal-overview) ุฏฺฉฺพ ุณฺฉุช ฺบ

---

## Entra ID ฺฉ ุณุงุชฺพ ุงูพู MCP ุณุฑูุฑ ฺฉ ุญูุงุธุช: ูุฑุญู ูุงุฑ ุฑููุงุฆ  

ุงุจุ ุขุฆ ุฏฺฉฺพุช ฺบ ฺฉ Entra ID ฺฉ ุฐุฑุน ุงฺฉ ููุงู MCP ุณุฑูุฑ (ุฌู `stdio` ฺฉ ุฐุฑุน ุจุงุช ฺุช ฺฉุฑุชุง ) ฺฉู ฺฉุณ ูุญููุธ ุจูุงุง ุฌุงุฆ  ูุซุงู ุงฺฉ **ุนูุงู ฺฉูุงุฆููน** ุงุณุชุนูุงู ฺฉุฑุช ุ ุฌู ุตุงุฑู ฺฉ ฺฉููพููนุฑ ูพุฑ ฺูู ูุงู ุงูพูฺฉุดูุฒ ุฌุณ ฺุณฺฉ ูนุงูพ ุงูพ ุง ููุงู ฺูููพูููน ุณุฑูุฑ ฺฉ ู ููุฒูฺบ 

### ููุธุฑูุงู 1: ููุงู MCP ุณุฑูุฑ ฺฉ ุญูุงุธุช (ุนูุงู ฺฉูุงุฆููน ฺฉ ุณุงุชฺพ)  

ุงุณ ููุธุฑูุงู ูฺบุ ู ุงฺฉ ุงุณ MCP ุณุฑูุฑ ฺฉู ุฏฺฉฺพฺบ ฺฏ ุฌู ููุงู ุทูุฑ ูพุฑ ฺูุชุง ุ `stdio` ฺฉ ุฐุฑุน ุจุงุช ฺุช ฺฉุฑุชุง ุ ุงูุฑ Entra ID ฺฉ ุฐุฑุน ุตุงุฑู ฺฉ ุชุตุฏู ฺฉุฑุชุง  ุชุงฺฉ ุงุณ ฺฉ ูนููุฒ ุชฺฉ ุฑุณุงุฆ ุฏ ุฌุง ุณฺฉ ุณุฑูุฑ ฺฉ ูพุงุณ ุงฺฉ ูนูู ูฺฏุง ุฌู Microsoft Graph API ุณ ุตุงุฑู ฺฉ ูพุฑููุงุฆู ูุนูููุงุช ุญุงุตู ฺฉุฑุชุง 

#### 1. Entra ID ูฺบ ุงูพูฺฉุดู ฺฉ ุฑุฌุณูนุฑุดู  

ฺฉูฺ ูฺฉฺพู ุณ ูพูุ ุขูพ ฺฉู ุงูพู ุงูพูฺฉุดู ฺฉู Microsoft Entra ID ูฺบ ุฑุฌุณูนุฑ ฺฉุฑูุง ูฺฏุง  Entra ID ฺฉู ุขูพ ฺฉ ุงูพูฺฉุดู ฺฉ ุจุงุฑ ูฺบ ุจุชุงุชุง  ุงูุฑ ุงุณ ุชุตุฏู ุณุฑูุณ ุงุณุชุนูุงู ฺฉุฑู ฺฉ ุงุฌุงุฒุช ุฏุชุง 

1. **[Microsoft Entra ูพูุฑูนู](https://entra.microsoft.com/)** ูพุฑ ุฌุงุฆฺบ  
2. **App registrations** ูฺบ ุฌุง ฺฉุฑ **New registration** ูพุฑ ฺฉูฺฉ ฺฉุฑฺบ  
3. ุงูพู ุงูพูฺฉุดู ฺฉุง ูุงู ุฏฺบ (ูุซูุงู "My Local MCP Server")  
4. **Supported account types** ูฺบ **Accounts in this organizational directory only** ููุชุฎุจ ฺฉุฑฺบ  
5. ุงุณ ูุซุงู ฺฉ ู **Redirect URI** ุฎุงู ฺฺพูฺ ุณฺฉุช ฺบ  
6. **Register** ูพุฑ ฺฉูฺฉ ฺฉุฑฺบ

ุฑุฌุณูนุฑุดู ฺฉ ุจุนุฏุ **Application (client) ID** ุงูุฑ **Directory (tenant) ID** ูููน ฺฉุฑ ูฺบุ ฺฉููฺฉ ุขูพ ฺฉู ฺฉูฺ ูฺบ ุงู ฺฉ ุถุฑูุฑุช ูฺฏ

#### 2. ฺฉูฺ: ุงฺฉ ุฌุงุฆุฒ  

ุขุฆ ฺฉูฺ ฺฉ ุงู ุญุตูฺบ ฺฉู ุฏฺฉฺพุช ฺบ ุฌู ุชุตุฏู ฺฉู ุณูุจฺพุงูุช ฺบ ุงุณ ูุซุงู ฺฉุง ูฺฉูู ฺฉูฺ [Entra ID - Local - WAM](https://github.com/Azure-Samples/mcp-auth-servers/tree/main/src/entra-id-local-wam) ูููฺุฑ ูฺบ ุฏุณุชุงุจ ุ ุฌู [mcp-auth-servers GitHub ุฑูพูุฒูนุฑ](https://github.com/Azure-Samples/mcp-auth-servers) ฺฉุง ุญุต 

**`AuthenticationService.cs`**  

 ฺฉูุงุณ Entra ID ฺฉ ุณุงุชฺพ ุชุนุงูู ฺฉ ุฐู ุฏุงุฑ 

- **`CreateAsync`**:  ุทุฑู MSAL ฺฉ `PublicClientApplication` ฺฉู ุดุฑูุน ฺฉุฑุชุง  ุงุณ ุขูพ ฺฉ ุงูพูฺฉุดู ฺฉ `clientId` ุงูุฑ `tenantId` ฺฉ ุณุงุชฺพ ุชุฑุชุจ ุฏุง ุฌุงุชุง   
- **`WithBroker`**:  ุจุฑูฺฉุฑ (ุฌุณ Windows Web Account Manager) ฺฉ ุงุณุชุนูุงู ฺฉู ูุนุงู ฺฉุฑุชุง ุ ุฌู ุฒุงุฏ ูุญููุธ ุงูุฑ ุขุณุงู ุณูฺฏู ุณุงุฆู ุขู ุชุฌุฑุจ ูุฑุงู ฺฉุฑุชุง   
- **`AcquireTokenAsync`**:  ุจูุงุฏ ุทุฑู   ูพู ุฎุงููุด ุณ ูนูฺฉู ุญุงุตู ฺฉุฑู ฺฉ ฺฉูุดุด ฺฉุฑุชุง  (ุนู ุงฺฏุฑ ุตุงุฑู ฺฉุง ุณุดู ูพู ุณ ููุฌูุฏ ู ุชู ุฏูุจุงุฑ ุณุงุฆู ุงู ฺฉ ุถุฑูุฑุช ูฺบ ูพฺุช) ุงฺฏุฑ ุฎุงููุด ุณ ูนูฺฉู ู ูู ุชู ุตุงุฑู ฺฉู ุงููนุฑุงฺฉูนู ุณุงุฆู ุงู ฺฉ ู ฺฉุง ุฌุงุชุง 

```csharp
// Simplified for clarity
public static async Task<AuthenticationService> CreateAsync(ILogger<AuthenticationService> logger)
{
    var msalClient = PublicClientApplicationBuilder
        .Create(_clientId) // Your Application (client) ID
        .WithAuthority(AadAuthorityAudience.AzureAdMyOrg)
        .WithTenantId(_tenantId) // Your Directory (tenant) ID
        .WithBroker(new BrokerOptions(BrokerOptions.OperatingSystems.Windows))
        .Build();

    // ... cache registration ...

    return new AuthenticationService(logger, msalClient);
}

public async Task<string> AcquireTokenAsync()
{
    try
    {
        // Try silent authentication first
        var accounts = await _msalClient.GetAccountsAsync();
        var account = accounts.FirstOrDefault();

        AuthenticationResult? result = null;

        if (account != null)
        {
            result = await _msalClient.AcquireTokenSilent(_scopes, account).ExecuteAsync();
        }
        else
        {
            // If no account, or silent fails, go interactive
            result = await _msalClient.AcquireTokenInteractive(_scopes).ExecuteAsync();
        }

        return result.AccessToken;
    }
    catch (Exception ex)
    {
        _logger.LogError(ex, "An error occurred while acquiring the token.");
        throw; // Optionally rethrow the exception for higher-level handling
    }
}
```

**`Program.cs`**  

ุงฺบ MCP ุณุฑูุฑ ุณูน ุงูพ ฺฉุง ุฌุงุชุง  ุงูุฑ ุชุตุฏู ุณุฑูุณ ฺฉู ุดุงูู ฺฉุง ุฌุงุชุง 

- **`AddSingleton<AuthenticationService>`**:  `AuthenticationService` ฺฉู dependency injection ฺฉููนูุฑ ูฺบ ุฑุฌุณูนุฑ ฺฉุฑุชุง  ุชุงฺฉ ุงูพูฺฉุดู ฺฉ ุฏฺฏุฑ ุญุต (ุฌุณ ูุงุฑุง ูนูู) ุงุณ ุงุณุชุนูุงู ฺฉุฑ ุณฺฉฺบ  
- **`GetUserDetailsFromGraph` ูนูู**: ุงุณ ูนูู ฺฉู `AuthenticationService` ฺฉ ุงฺฉ ูุซุงู ฺฉ ุถุฑูุฑุช ูุช   ุณุจ ุณ ูพู `authService.AcquireTokenAsync()` ฺฉุงู ฺฉุฑุชุง  ุชุงฺฉ ุงฺฉ ุฏุฑุณุช access token ุญุงุตู ฺฉุง ุฌุง ุณฺฉ ุงฺฏุฑ ุชุตุฏู ฺฉุงูุงุจ ู ุชู  ูนูฺฉู ุงุณุชุนูุงู ฺฉุฑุช ูุฆ Microsoft Graph API ฺฉู ฺฉุงู ฺฉุฑุชุง  ุงูุฑ ุตุงุฑู ฺฉ ุชูุตูุงุช ุญุงุตู ฺฉุฑุชุง 

```csharp
// Simplified for clarity
[McpServerTool(Name = "GetUserDetailsFromGraph")]
public static async Task<string> GetUserDetailsFromGraph(
    AuthenticationService authService)
{
    try
    {
        // This will trigger the authentication flow
        var accessToken = await authService.AcquireTokenAsync();

        // Use the token to create a GraphServiceClient
        var graphClient = new GraphServiceClient(
            new BaseBearerTokenAuthenticationProvider(new TokenProvider(authService)));

        var user = await graphClient.Me.GetAsync();

        return System.Text.Json.JsonSerializer.Serialize(user);
    }
    catch (Exception ex)
    {
        return $"Error: {ex.Message}";
    }
}
```

#### 3.  ุณุจ ฺฉุณ ูู ฺฉุฑ ฺฉุงู ฺฉุฑุชุง   

1. ุฌุจ MCP ฺฉูุงุฆููน `GetUserDetailsFromGraph` ูนูู ุงุณุชุนูุงู ฺฉุฑู ฺฉ ฺฉูุดุด ฺฉุฑุชุง ุ ุชู ูนูู ุณุจ ุณ ูพู `AcquireTokenAsync` ฺฉุงู ฺฉุฑุชุง   
2. `AcquireTokenAsync` MSAL ูุงุฆุจุฑุฑ ฺฉู ุงฺฉ ุฏุฑุณุช ูนูฺฉู ุชูุงุด ฺฉุฑู ฺฉุง ฺฉุชุง   
3. ุงฺฏุฑ ฺฉูุฆ ูนูฺฉู ูฺบ ููุชุงุ ุชู MSAL ุจุฑูฺฉุฑ ฺฉ ุฐุฑุน ุตุงุฑู ฺฉู Entra ID ุงฺฉุงุคููน ุณ ุณุงุฆู ุงู ฺฉุฑู ฺฉุง ฺฉุชุง   
4. ุตุงุฑู ุณุงุฆู ุงู ฺฉุฑุชุง ุ ุงูุฑ Entra ID ุงฺฉ access token ุฌุงุฑ ฺฉุฑุชุง   
5. ูนูู  ูนูฺฉู ูุตูู ฺฉุฑุชุง  ุงูุฑ Microsoft Graph API ฺฉู ูุญููุธ ฺฉุงู ฺฉ ู ุงุณุชุนูุงู ฺฉุฑุชุง   
6. ุตุงุฑู ฺฉ ุชูุตูุงุช MCP ฺฉูุงุฆููน ฺฉู ูุงูพุณ ฺฉุฑ ุฏ ุฌุงุช ฺบ

 ุนูู ูู ุจูุงุชุง  ฺฉ ุตุฑู ุชุตุฏู ุดุฏ ุตุงุฑูู  ูนูู ุงุณุชุนูุงู ฺฉุฑ ุณฺฉฺบุ ุงูุฑ ุงุณ ุทุฑุญ ุขูพ ฺฉุง ููุงู MCP ุณุฑูุฑ ูุญููุธ ุฑุชุง 

### ููุธุฑูุงู 2: ุฏูุฑ ุฏุฑุงุฒ MCP ุณุฑูุฑ ฺฉ ุญูุงุธุช (ุฎู ฺฉูุงุฆููน ฺฉ ุณุงุชฺพ)  

ุฌุจ ุขูพ ฺฉุง MCP ุณุฑูุฑ ุฏูุฑ ุฏุฑุงุฒ ูุดู ูพุฑ ฺู ุฑุง ู (ุฌุณ ฺฉูุงุคฺ ุณุฑูุฑ) ุงูุฑ HTTP Streaming ุฌุณ ูพุฑููนูฺฉูู ฺฉ ุฐุฑุน ุจุงุช ฺุช ฺฉุฑุชุง ูุ ุชู ุณฺฉูุฑูน ฺฉ ุถุฑูุฑุงุช ูุฎุชูู ูุช ฺบ ุงุณ ุตูุฑุช ูฺบุ ุขูพ ฺฉู **confidential client** ุงูุฑ **Authorization Code Flow** ุงุณุชุนูุงู ฺฉุฑูุง ฺุง  ุฒุงุฏ ูุญููุธ ุทุฑู  ฺฉููฺฉ ุงูพูฺฉุดู ฺฉ ุฑุงุฒ ฺฉุจฺพ ุจุฑุงุคุฒุฑ ฺฉ ุณุงูู ุธุงุฑ ูฺบ ูุช

 ูุซุงู TypeScript ูพุฑ ูุจู MCP ุณุฑูุฑ ฺฉ  ุฌู Express.js ุงุณุชุนูุงู ฺฉุฑุชุง  HTTP ุฏุฑุฎูุงุณุชูฺบ ฺฉู ูฺู ฺฉุฑู ฺฉ ู

#### 1. Entra ID ูฺบ ุงูพูฺฉุดู ฺฉ ุฑุฌุณูนุฑุดู  

Entra ID ูฺบ ุณูน ุงูพ ุนูุงู ฺฉูุงุฆููน ฺฉ ุทุฑุญ ุ ูฺฏุฑ ุงฺฉ ุงู ูุฑู ฺฉ ุณุงุชฺพ: ุขูพ ฺฉู **client secret** ุจูุงูุง ูฺฏุง

1. **[Microsoft Entra ูพูุฑูนู](https://entra.microsoft.com/)** ูพุฑ ุฌุงุฆฺบ  
2. ุงูพู ุงูพูฺฉุดู ฺฉ ุฑุฌุณูนุฑุดู ูฺบ **Certificates & secrets** ูนุจ ูพุฑ ุฌุงุฆฺบ  
3. **New client secret** ูพุฑ ฺฉูฺฉ ฺฉุฑฺบุ ุงฺฉ ูุถุงุญุช ุฏฺบุ ุงูุฑ **Add** ูพุฑ ฺฉูฺฉ ฺฉุฑฺบ  
4. **ุงู:** ุณฺฉุฑูน ููู ฺฉู ููุฑุงู ฺฉุงูพ ฺฉุฑ ูฺบ ฺฉููฺฉ ุขูพ ุงุณ ุฏูุจุงุฑ ูฺบ ุฏฺฉฺพ ุณฺฉฺบ ฺฏ  
5. ุขูพ ฺฉู **Redirect URI** ุจฺพ ุชุฑุชุจ ุฏู ูฺฏ **Authentication** ูนุจ ูฺบ ุฌุงุฆฺบุ **Add a platform** ูพุฑ ฺฉูฺฉ ฺฉุฑฺบุ **Web** ููุชุฎุจ ฺฉุฑฺบุ ุงูุฑ ุงูพู ุงูพูฺฉุดู ฺฉ ู redirect URI ุฏุฑุฌ ฺฉุฑฺบ (ูุซูุงู `http://localhost:3001/auth/callback`)

> **โ๏ธ ุงู ุณฺฉูุฑูน ูููน:** ูพุฑูฺฺฉุดู ุงูพูฺฉุดูุฒ ฺฉ ูุ Microsoft ุณุฎุช ุณ ุณูุงุฑุด ฺฉุฑุชุง  ฺฉ **secretless authentication** ุทุฑู ุงุณุชุนูุงู ฺฉ ุฌุงุฆฺบ ุฌุณ **Managed Identity** ุง **Workload Identity Federation** ุจุฌุงุฆ client secrets ฺฉ client secrets ุณฺฉูุฑูน ุฎุทุฑุงุช ูพุฏุง ฺฉุฑ ุณฺฉุช ฺบ ฺฉููฺฉ  ุธุงุฑ ุง ุณูุฌฺพูุช ฺฉ ุฌุง ุณฺฉุช ฺบ Managed identities ุงฺฉ ุฒุงุฏ ูุญููุธ ุทุฑู ูุฑุงู ฺฉุฑุช ฺบ ฺฉููฺฉ ุงุณ ูฺบ ุขูพ ฺฉู ุงูพู ฺฉูฺ ุง ฺฉููฺฏุฑุดู ูฺบ ุงุณูุงุฏ ูุญููุธ ฺฉุฑู ฺฉ ุถุฑูุฑุช ูฺบ ูพฺุช  
>  
> ูุฒุฏ ูุนูููุงุช ฺฉ ูุ [Managed identities for Azure resources overview](https://learn.microsoft.com/entra/identity/managed-identities-azure-resources/overview) ุฏฺฉฺพฺบ

#### 2. ฺฉูฺ: ุงฺฉ ุฌุงุฆุฒ  

 ูุซุงู ุณุดู ูพุฑ ูุจู  ุฌุจ ุตุงุฑู ุชุตุฏู ฺฉุฑุชุง ุ ุชู ุณุฑูุฑ access token ุงูุฑ refresh token ฺฉู ุณุดู ูฺบ ูุญููุธ ฺฉุฑุชุง  ุงูุฑ ุตุงุฑู ฺฉู ุงฺฉ ุณุดู ูนูฺฉู ุฏุชุง   ุณุดู ูนูฺฉู ุจุนุฏ ฺฉ ุฏุฑุฎูุงุณุชูฺบ ฺฉ ู ุงุณุชุนูุงู ูุชุง  ุงุณ ูุซุงู ฺฉุง ูฺฉูู ฺฉูฺ [Entra ID - Confidential client](https://github.com/Azure-Samples/mcp-auth-servers/tree/main/src/entra-id-cca-session) ูููฺุฑ ูฺบ ุฏุณุชุงุจ ุ ุฌู [mcp-auth-servers GitHub ุฑูพูุฒูนุฑ](https://github.com/Azure-Samples/mcp-auth-servers) ฺฉุง ุญุต 

**`Server.ts`**  

 ูุงุฆู Express ุณุฑูุฑ ุงูุฑ MCP ูนุฑุงูุณูพูุฑูน ูุฆุฑ ฺฉู ุณูน ุงูพ ฺฉุฑุช 

- **`requireBearerAuth`**:  middleware `/sse` ุงูุฑ `/message` ุงูฺ ูพูุงุฆููนุณ ฺฉ ุญูุงุธุช ฺฉุฑุชุง   ุฏุฑุฎูุงุณุช ฺฉ `Authorization` ฺุฑ ูฺบ ุงฺฉ ุฏุฑุณุช bearer token ฺฉ ุฌุงูฺ ฺฉุฑุชุง   
- **`EntraIdServerAuthProvider`**:  ุงฺฉ ฺฉุณูนู ฺฉูุงุณ  ุฌู `McpServerAuthorizationProvider` ุงููนุฑูุณ ฺฉู ูุงูุฐ ฺฉุฑุช   OAuth 2.0 ููู ฺฉู ุณูุจฺพุงูู ฺฉ ุฐู ุฏุงุฑ   
- **`/auth/callback`**:  ุงูฺ ูพูุงุฆููน Entra ID ุณ ุตุงุฑู ฺฉ ุชุตุฏู ฺฉ ุจุนุฏ redirect ฺฉู ูฺู ฺฉุฑุชุง   authorization code ฺฉู access token ุงูุฑ refresh token ูฺบ ุชุจุฏู ฺฉุฑุชุง 

```typescript
// Simplified for clarity
const app = express();
const { server } = createServer();
const provider = new EntraIdServerAuthProvider();

// Protect the SSE endpoint
app.get("/sse", requireBearerAuth({
  provider,
  requiredScopes: ["User.Read"]
}), async (req, res) => {
  // ... connect to the transport ...
});

// Protect the message endpoint
app.post("/message", requireBearerAuth({
  provider,
  requiredScopes: ["User.Read"]
}), async (req, res) => {
  // ... handle the message ...
});

// Handle the OAuth 2.0 callback
app.get("/auth/callback", (req, res) => {
  provider.handleCallback(req.query.code, req.query.state)
    .then(result => {
      // ... handle success or failure ...
    });
});
```

**`Tools.ts`**  

 ูุงุฆู MCP ุณุฑูุฑ ฺฉ ูุฑุงู ฺฉุฑุฏ ูนููุฒ ฺฉ ุชุนุฑู ฺฉุฑุช  `getUserDetails` ูนูู ูพฺฺพู ูุซุงู ฺฉ ุทุฑุญ ุ ูฺฏุฑ  access token ุณุดู ุณ ุญุงุตู ฺฉุฑุชุง 

```typescript
// Simplified for clarity
server.setRequestHandler(CallToolRequestSchema, async (request) => {
  const { name } = request.params;
  const context = request.params?.context as { token?: string } | undefined;
  const sessionToken = context?.token;

  if (name === ToolName.GET_USER_DETAILS) {
    if (!sessionToken) {
      throw new AuthenticationError("Authentication token is missing or invalid. Ensure the token is provided in the request context.");
    }

    // Get the Entra ID token from the session store
    const tokenData = tokenStore.getToken(sessionToken);
    const entraIdToken = tokenData.accessToken;

    const graphClient = Client.init({
      authProvider: (done) => {
        done(null, entraIdToken);
      }
    });

    const user = await graphClient.api('/me').get();

    // ... return user details ...
  }
});
```

**`auth/EntraIdServerAuthProvider.ts`**  

 ฺฉูุงุณ ุฏุฑุฌ ุฐู ฺฉุงู ุงูุฌุงู ุฏุช :

- ุตุงุฑู ฺฉู Entra ID ุณุงุฆู ุงู ุตูุญ ูพุฑ ุฑ ฺุงุฆุฑฺฉูน ฺฉุฑูุง  
- authorization code ฺฉู access token ูฺบ ุชุจุฏู ฺฉุฑูุง  
- tokens ฺฉู `tokenStore` ูฺบ ูุญููุธ ฺฉุฑูุง  
- access token ฺฉ ูุนุงุฏ ุฎุชู ูู ูพุฑ ุงุณ ุฑูุฑุด ฺฉุฑูุง

#### 3.  ุณุจ ฺฉุณ ูู ฺฉุฑ ฺฉุงู ฺฉุฑุชุง   

1. ุฌุจ ุตุงุฑู ูพู ุจุงุฑ MCP ุณุฑูุฑ ุณ ฺฉูฺฉูน ฺฉุฑู ฺฉ ฺฉูุดุด ฺฉุฑุชุง ุ ุชู `requireBearerAuth` middleware ุฏฺฉฺพุชุง  ฺฉ ุงุณ ฺฉ ูพุงุณ ฺฉูุฆ ุฏุฑุณุช ุณุดู ูฺบ  ุงูุฑ ุงุณ Entra ID ุณุงุฆู ุงู ุตูุญ ูพุฑ ุฑ ฺุงุฆุฑฺฉูน ฺฉุฑ ุฏุชุง   
2. ุตุงุฑู ุงูพู Entra ID ุงฺฉุงุคููน ุณ ุณุงุฆู ุงู ฺฉุฑุชุง   
3. Entra ID ุตุงุฑู ฺฉู `/auth/callback` ุงูฺ ูพูุงุฆููน ูพุฑ authorization code ฺฉ ุณุงุชฺพ ุฑ ฺุงุฆุฑฺฉูน ฺฉุฑุชุง 
4. ุณุฑูุฑ ฺฉูฺ ฺฉู ุงฺฉุณุณ ูนูฺฉู ุงูุฑ ุฑูุฑุด ูนูฺฉู ฺฉ ุจุฏู ูฺบ ุชุจุฏู ฺฉุฑุชุง ุ ุงูฺบ ูุญููุธ ฺฉุฑุชุง ุ ุงูุฑ ุงฺฉ ุณุดู ูนูฺฉู ุจูุงุชุง  ุฌู ฺฉูุงุฆููน ฺฉู ุจฺพุฌุง ุฌุงุชุง   
5. ฺฉูุงุฆููน ุงุจ ุงุณ ุณุดู ูนูฺฉู ฺฉู `Authorization` ฺุฑ ูฺบ ุงุณุชุนูุงู ฺฉุฑ ุณฺฉุชุง  ุชุงฺฉ MCP ุณุฑูุฑ ฺฉู ุชูุงู ุขุฆูุฏ ุฏุฑุฎูุงุณุชูฺบ ูฺบ ุจฺพุฌ  
6. ุฌุจ `getUserDetails` ูนูู ฺฉุงู ฺฉุง ุฌุงุชุง ุ ุชู  ุณุดู ูนูฺฉู ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ Entra ID ุงฺฉุณุณ ูนูฺฉู ุชูุงุด ฺฉุฑุชุง  ุงูุฑ ูพฺพุฑ ุงุณ ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ Microsoft Graph API ฺฉู ฺฉุงู ฺฉุฑุชุง   

 ุนูู ูพุจูฺฉ ฺฉูุงุฆููน ููู ุณ ุฒุงุฏ ูพฺุฏ ุ ูฺฉู ุงููนุฑููน ูพุฑ ุฏุณุชุงุจ ุงูฺ ูพูุงุฆููนุณ ฺฉ ู ุถุฑูุฑ  ฺููฺฉ ุฑูููน MCP ุณุฑูุฑุฒ ุนูุงู ุงููนุฑููน ูพุฑ ูุงุจู ุฑุณุงุฆ ูุช ฺบุ ุงูฺบ ุบุฑ ูุฌุงุฒ ุฑุณุงุฆ ุงูุฑ ููฺฉู ุญูููฺบ ุณ ุจฺุงู ฺฉ ู ูุถุจูุท ุณฺฉูุฑูน ุงูุฏุงูุงุช ฺฉ ุถุฑูุฑุช ูุช   


## Security Best Practices

- **ูุด HTTPS ุงุณุชุนูุงู ฺฉุฑฺบ**: ฺฉูุงุฆููน ุงูุฑ ุณุฑูุฑ ฺฉ ุฏุฑูุงู ููุงุตูุงุช ฺฉู ุงูฺฉุฑูพูน ฺฉุฑฺบ ุชุงฺฉ ูนูฺฉูุฒ ฺฉู ูุฏุงุฎูุช ุณ ูุญููุธ ุฑฺฉฺพุง ุฌุง ุณฺฉ  
- **Role-Based Access Control (RBAC) ูุงูุฐ ฺฉุฑฺบ**: ุตุฑู  ู ฺฺฉ ฺฉุฑฺบ ฺฉ ุตุงุฑู ูุณุชูุฏ  ุง ูฺบุ ุจูฺฉ  ุจฺพ ฺฺฉ ฺฉุฑฺบ ฺฉ ุงุณ ฺฉุง ฺฉุฑู ฺฉ ุงุฌุงุฒุช  ุขูพ Entra ID ูฺบ ุฑููุฒ ฺูุงุฆู ฺฉุฑ ุณฺฉุช ฺบ ุงูุฑ ุงูฺบ ุงูพู MCP ุณุฑูุฑ ูฺบ ฺฺฉ ฺฉุฑ ุณฺฉุช ฺบ  
- **ูุงููนุฑ ุงูุฑ ุขฺูน ฺฉุฑฺบ**: ุชูุงู ุชุตุฏู ูุงูุนุงุช ฺฉู ูุงฺฏ ฺฉุฑฺบ ุชุงฺฉ ูุดฺฉูฺฉ ุณุฑฺฏุฑู ฺฉุง ูพุช ูฺฏุง ฺฉุฑ ุงุณ ฺฉุง ุฌูุงุจ ุฏุง ุฌุง ุณฺฉ  
- **ุฑูน ูููนูฺฏ ุงูุฑ ุชฺพุฑููนููฺฏ ฺฉู ูฺู ฺฉุฑฺบ**: Microsoft Graph ุงูุฑ ุฏฺฏุฑ APIs ุฑูน ูููนูฺฏ ูุงูุฐ ฺฉุฑุช ฺบ ุชุงฺฉ ุบูุท ุงุณุชุนูุงู ฺฉู ุฑูฺฉุง ุฌุง ุณฺฉ ุงูพู MCP ุณุฑูุฑ ูฺบ ุงฺฉุณูพูููุดู ุจฺฉ ุขู ุงูุฑ ุฑูนุฑ ูุงุฌฺฉ ูุงูุฐ ฺฉุฑฺบ ุชุงฺฉ HTTP 429 (Too Many Requests) ฺฉ ุฌูุงุจุงุช ฺฉู ูุคุซุฑ ุทุฑู ุณ ูฺู ฺฉุง ุฌุง ุณฺฉ ุงฺฉุซุฑ ุงุณุชุนูุงู ูู ูุงู ฺูนุง ฺฉู ฺฉุด ฺฉุฑู ูพุฑ ุบูุฑ ฺฉุฑฺบ ุชุงฺฉ API ฺฉุงูุฒ ฺฉู ูฺบ  
- **ูนูฺฉู ุงุณูนูุฑุฌ ฺฉู ูุญููุธ ุจูุงุฆฺบ**: ุงฺฉุณุณ ูนูฺฉูุฒ ุงูุฑ ุฑูุฑุด ูนูฺฉูุฒ ฺฉู ูุญููุธ ุทุฑู ุณ ุฐุฎุฑ ฺฉุฑฺบ ููฺฉู ุงูพูฺฉุดูุฒ ฺฉ ูุ ุณุณูนู ฺฉ ูุญููุธ ุงุณูนูุฑุฌ ูฺฉุงูุฒู ุงุณุชุนูุงู ฺฉุฑฺบ ุณุฑูุฑ ุงูพูฺฉุดูุฒ ฺฉ ูุ ุงูฺฉุฑูพูนฺ ุงุณูนูุฑุฌ ุง Azure Key Vault ุฌุณ ูุญููุธ ฺฉ ููุฌูููน ุณุฑูุณุฒ ุงุณุชุนูุงู ฺฉุฑู ูพุฑ ุบูุฑ ฺฉุฑฺบ  
- **ูนูฺฉู ฺฉ ูุนุงุฏ ุฎุชู ูู ฺฉุง ุงูุชุธุงู ฺฉุฑฺบ**: ุงฺฉุณุณ ูนูฺฉู ฺฉ ูุญุฏูุฏ ูุฏุช ูุช  ุฑูุฑุด ูนูฺฉูุฒ ฺฉุง ุงุณุชุนูุงู ฺฉุฑุช ูุฆ ุฎูุฏฺฉุงุฑ ูนูฺฉู ุฑูุฑุด ูุงูุฐ ฺฉุฑฺบ ุชุงฺฉ ุตุงุฑู ฺฉู ุฏูุจุงุฑ ุชุตุฏู ฺฉ ุถุฑูุฑุช ู ูพฺ ุงูุฑ ุชุฌุฑุจ ููุงุฑ ุฑ  
- **Azure API Management ฺฉ ุงุณุชุนูุงู ูพุฑ ุบูุฑ ฺฉุฑฺบ**: ุงฺฏุฑฺ ุงูพู MCP ุณุฑูุฑ ูฺบ ุณฺฉูุฑูน ุจุฑุง ุฑุงุณุช ูุงูุฐ ฺฉุฑู ุณ ุขูพ ฺฉู ุจุงุฑฺฉ ุจู ุณ ฺฉููนุฑูู ููุชุง ุ API ฺฏูน ูุฒ ุฌุณ Azure API Management ุจุช ุณ ุณฺฉูุฑูน ูุณุงุฆู ฺฉู ุฎูุฏฺฉุงุฑ ุทุฑู ุณ ุณูุจฺพุงู ุณฺฉุช ฺบุ ุฌู ูฺบ ุชุตุฏูุ ุงุฌุงุฒุชุ ุฑูน ูููนูฺฏุ ุงูุฑ ูุงููนุฑูฺฏ ุดุงูู ฺบ  ุงฺฉ ูุฑฺฉุฒ ุณฺฉูุฑูน ูพุฑุช ูุฑุงู ฺฉุฑุช ฺบ ุฌู ุขูพ ฺฉ ฺฉูุงุฆููนุณ ุงูุฑ MCP ุณุฑูุฑุฒ ฺฉ ุฏุฑูุงู ูุช  MCP ฺฉ ุณุงุชฺพ API ฺฏูน ูุฒ ฺฉ ุงุณุชุนูุงู ฺฉ ูุฒุฏ ุชูุตูุงุช ฺฉ ูุ ูุงุฑ [Azure API Management Your Auth Gateway For MCP Servers](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690) ุฏฺฉฺพฺบ  


## Key Takeaways

- ุงูพู MCP ุณุฑูุฑ ฺฉู ูุญููุธ ุจูุงูุง ุขูพ ฺฉ ฺูนุง ุงูุฑ ูนููุฒ ฺฉ ุญูุงุธุช ฺฉ ู ุงูุชุงุฆ ุงู   
- Microsoft Entra ID ุชุตุฏู ุงูุฑ ุงุฌุงุฒุช ฺฉ ู ุงฺฉ ูุถุจูุท ุงูุฑ ูุงุจู ุชูุณุน ุญู ูุฑุงู ฺฉุฑุชุง   
- ููฺฉู ุงูพูฺฉุดูุฒ ฺฉ ู **public client** ุงูุฑ ุฑูููน ุณุฑูุฑุฒ ฺฉ ู **confidential client** ุงุณุชุนูุงู ฺฉุฑฺบ  
- ูุจ ุงูพูฺฉุดูุฒ ฺฉ ู **Authorization Code Flow** ุณุจ ุณ ุฒุงุฏ ูุญููุธ ุขูพุดู   


## Exercise

1. ุงฺฉ MCP ุณุฑูุฑ ฺฉ ุจุงุฑ ูฺบ ุณูฺฺบ ุฌู ุขูพ ุจูุง ุณฺฉุช ฺบ ฺฉุง  ููฺฉู ุณุฑูุฑ ูฺฏุง ุง ุฑูููน ุณุฑูุฑุ  
2. ุงูพู ุฌูุงุจ ฺฉ ุจูุงุฏ ูพุฑุ ฺฉุง ุขูพ public ุง confidential client ุงุณุชุนูุงู ฺฉุฑฺบ ฺฏุ  
3. Microsoft Graph ฺฉ ุฎูุงู ฺฉุงุฑุฑูุงุฆุงฺบ ฺฉุฑู ฺฉ ู ุขูพ ฺฉุง MCP ุณุฑูุฑ ฺฉูู ุณ ุงุฌุงุฒุช ุทูุจ ฺฉุฑ ฺฏุงุ  


## Hands-on Exercises

### Exercise 1: Entra ID ูฺบ ุงฺฉ ุงูพูฺฉุดู ุฑุฌุณูนุฑ ฺฉุฑฺบ  
Microsoft Entra ูพูุฑูนู ูพุฑ ุฌุงุฆฺบ  
ุงูพู MCP ุณุฑูุฑ ฺฉ ู ุงฺฉ ูุฆ ุงูพูฺฉุดู ุฑุฌุณูนุฑ ฺฉุฑฺบ  
Application (client) ID ุงูุฑ Directory (tenant) ID ูููน ฺฉุฑฺบ  

### Exercise 2: ููฺฉู MCP ุณุฑูุฑ ฺฉู ูุญููุธ ุจูุงุฆฺบ (Public Client)  
- ุตุงุฑู ฺฉ ุชุตุฏู ฺฉ ู MSAL (Microsoft Authentication Library) ฺฉู ุงููนฺฏุฑูน ฺฉุฑู ฺฉ ู ฺฉูฺ ูุซุงู ูพุฑ ุนูู ฺฉุฑฺบ  
- Microsoft Graph ุณ ุตุงุฑู ฺฉ ุชูุตูุงุช ุญุงุตู ฺฉุฑู ูุงู MCP ูนูู ฺฉู ฺฉุงู ฺฉุฑ ฺฉ ุชุตุฏู ููู ฺฉ ุฌุงูฺ ฺฉุฑฺบ  

### Exercise 3: ุฑูููน MCP ุณุฑูุฑ ฺฉู ูุญููุธ ุจูุงุฆฺบ (Confidential Client)  
- Entra ID ูฺบ ุงฺฉ confidential client ุฑุฌุณูนุฑ ฺฉุฑฺบ ุงูุฑ ุงฺฉ client secret ุจูุงุฆฺบ  
- ุงูพู Express.js MCP ุณุฑูุฑ ฺฉู Authorization Code Flow ุงุณุชุนูุงู ฺฉุฑู ฺฉ ู ฺฉููฺฏุฑ ฺฉุฑฺบ  
- ูุญููุธ ุงูฺ ูพูุงุฆููนุณ ฺฉ ุฌุงูฺ ฺฉุฑฺบ ุงูุฑ ูนูฺฉู ฺฉ ุจูุงุฏ ูพุฑ ุฑุณุงุฆ ฺฉ ุชุตุฏู ฺฉุฑฺบ  

### Exercise 4: ุณฺฉูุฑูน ฺฉ ุจุชุฑู ูุดูฺบ ุงูพูุงุฆฺบ  
- ุงูพู ููฺฉู ุง ุฑูููน ุณุฑูุฑ ฺฉ ู HTTPS ูุนุงู ฺฉุฑฺบ  
- ุงูพู ุณุฑูุฑ ูุงุฌฺฉ ูฺบ ุฑูู ุจุณฺ ุงฺฉุณุณ ฺฉููนุฑูู (RBAC) ูุงูุฐ ฺฉุฑฺบ  
- ูนูฺฉู ฺฉ ูุนุงุฏ ุฎุชู ูู ฺฉุง ุงูุชุธุงู ุงูุฑ ูุญููุธ ูนูฺฉู ุงุณูนูุฑุฌ ุดุงูู ฺฉุฑฺบ  


## Resources

1. **MSAL Overview Documentation**  
   ุฌุงูฺบ ฺฉ Microsoft Authentication Library (MSAL) ฺฉุณ ุทุฑุญ ูุฎุชูู ูพููน ูุงุฑูุฒ ูพุฑ ูุญููุธ ูนูฺฉู ุญุงุตู ฺฉุฑู ฺฉ ุณููุช ุฏุชุง :  
   [MSAL Overview on Microsoft Learn](https://learn.microsoft.com/en-gb/entra/msal/overview)  

2. **Azure-Samples/mcp-auth-servers GitHub Repository**  
   MCP ุณุฑูุฑุฒ ฺฉ ุชุตุฏู ููู ฺฉ ุฑูุฑูุณ ุงููพููููนุดูุฒ:  
   [Azure-Samples/mcp-auth-servers on GitHub](https://github.com/Azure-Samples/mcp-auth-servers)  

3. **Managed Identities for Azure Resources Overview**  
   ุณุณูนู ุง ูุฒุฑ ุงุณุงุฆูฺ ููุฌฺ ุขุฆฺููนุฒ ฺฉ ุฐุฑุน ุณฺฉุฑูนุณ ฺฉู ุฎุชู ฺฉุฑู ฺฉุง ุทุฑู ุณูุฌฺพฺบ:  
   [Managed Identities Overview on Microsoft Learn](https://learn.microsoft.com/en-us/entra/identity/managed-identities-azure-resources/)  

4. **Azure API Management: Your Auth Gateway for MCP Servers**  
   MCP ุณุฑูุฑุฒ ฺฉ ู APIM ฺฉู ุงฺฉ ูุญููุธ OAuth2 ฺฏูน ู ฺฉ ุทูุฑ ูพุฑ ุงุณุชุนูุงู ฺฉุฑู ฺฉ ุชูุตู ุฑููุงุฆ:  
   [Azure API Management Your Auth Gateway For MCP Servers](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)  

5. **Microsoft Graph Permissions Reference**  
   Microsoft Graph ฺฉ ู ุชููุถ ุดุฏ ุงูุฑ ุงูพูฺฉุดู ูพุฑูุดูุฒ ฺฉ ูฺฉูู ูุฑุณุช:  
   [Microsoft Graph Permissions Reference](https://learn.microsoft.com/zh-tw/graph/permissions-reference)  


## Learning Outcomes  
ุงุณ ุณฺฉุดู ฺฉู ูฺฉูู ฺฉุฑู ฺฉ ุจุนุฏุ ุขูพ ูุงุจู ูฺบ ฺฏ ฺฉ:  

- ูุถุงุญุช ฺฉุฑฺบ ฺฉ MCP ุณุฑูุฑุฒ ุงูุฑ AI ูุฑฺฉ ููู ฺฉ ู ุชุตุฏู ฺฉูฺบ ุถุฑูุฑ   
- Entra ID ฺฉ ุชุตุฏู ฺฉู ููฺฉู ุงูุฑ ุฑูููน MCP ุณุฑูุฑ ฺฉ ููุธุฑูุงููฺบ ฺฉ ู ุณูน ุงูพ ุงูุฑ ฺฉููฺฏุฑ ฺฉุฑฺบ  
- ุงูพู ุณุฑูุฑ ฺฉ ุชุนูุงุช ฺฉ ุจูุงุฏ ูพุฑ ููุงุณุจ ฺฉูุงุฆููน ฺฉ ูุณู (public ุง confidential) ููุชุฎุจ ฺฉุฑฺบ  
- ูุญููุธ ฺฉูฺูฺฏ ฺฉ ูุดูฺบ ูุงูุฐ ฺฉุฑฺบุ ุฌู ูฺบ ูนูฺฉู ุงุณูนูุฑุฌ ุงูุฑ ุฑูู ุจุณฺ ุงุฌุงุฒุช ุดุงูู ฺบ  
- ุงูพู MCP ุณุฑูุฑ ุงูุฑ ุงุณ ฺฉ ูนููุฒ ฺฉู ุบุฑ ูุฌุงุฒ ุฑุณุงุฆ ุณ ูุคุซุฑ ุทุฑู ุณ ูุญููุธ ุจูุงุฆฺบ  


## What's next  

- [5.13 Model Context Protocol (MCP) Integration with Azure AI Foundry](../mcp-foundry-agent-integration/README.md)

**ุฏุณุชุฎุท ูููน**:  
 ุฏุณุชุงูุฒ AI ุชุฑุฌู ุณุฑูุณ [Co-op Translator](https://github.com/Azure/co-op-translator) ฺฉ ุฐุฑุน ุชุฑุฌู ฺฉ ฺฏุฆ  ุงฺฏุฑฺ ู ุฏุฑุณุชฺฏ ฺฉ ู ฺฉูุดุงฺบ ฺบุ ุจุฑุง ฺฉุฑู ุขฺฏุง ุฑฺบ ฺฉ ุฎูุฏฺฉุงุฑ ุชุฑุฌู ูฺบ ุบูุทุงฺบ ุง ุนุฏู ุฏุฑุณุชุงฺบ ู ุณฺฉุช ฺบ ุงุตู ุฏุณุชุงูุฒ ุงูพู ูุงุฏุฑ ุฒุจุงู ูฺบ  ูุนุชุจุฑ ูุงุฎุฐ ุณูุฌฺพ ุฌุงู ฺุง ุงู ูุนูููุงุช ฺฉ ู ูพุด ูุฑ ุงูุณุงู ุชุฑุฌู ฺฉ ุณูุงุฑุด ฺฉ ุฌุงุช  ุงุณ ุชุฑุฌู ฺฉ ุงุณุชุนูุงู ุณ ูพุฏุง ูู ูุงู ฺฉุณ ุจฺพ ุบูุท ูู ุง ุบูุท ุชุดุฑุญ ฺฉ ุฐู ุฏุงุฑ ู ูพุฑ ุนุงุฆุฏ ูฺบ ูุช